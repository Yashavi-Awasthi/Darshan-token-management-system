<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>üõï Mandir Admin Onboarding</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ================= ROOT ================= */
:root{
  --saffron:#ff9933;
  --deep:#b85c00;
  --light:#fff3e0;
  --card:rgba(255,255,255,0.92);
}

*{box-sizing:border-box}

/* ================= BODY ================= */
body{
  margin:0;
  min-height:100vh;
  font-family: "Segoe UI", Arial, sans-serif;
  background:
    linear-gradient(rgba(255,153,51,.88), rgba(255,200,120,.88)),
    url("https://i.imgur.com/2RZ7K6R.png");
  background-size:cover;
  background-position:center;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:20px;
}

/* ================= CARD ================= */
.card{
  width:100%;
  max-width:520px;
  background:var(--card);
  border-radius:18px;
  padding:28px 26px 32px;
  box-shadow:0 20px 50px rgba(0,0,0,.25);
  backdrop-filter: blur(6px);
  animation: floatIn .9s ease;
}

@keyframes floatIn{
  from{opacity:0; transform:translateY(25px)}
  to{opacity:1; transform:translateY(0)}
}

/* ================= HEAD ================= */
h2{
  margin-top:0;
  text-align:center;
  color:#5c2b00;
}

.subtitle{
  text-align:center;
  color:#7a3c00;
  margin-bottom:18px;
  font-size:15px;
}

/* ================= INPUT ================= */
input{
  width:100%;
  padding:14px;
  margin:10px 0;
  font-size:16px;
  border-radius:10px;
  border:1px solid #d8b38a;
  outline:none;
}

input:focus{
  border-color:var(--saffron);
  box-shadow:0 0 0 2px rgba(255,153,51,.2);
}

/* ================= BUTTON ================= */
button{
  width:100%;
  margin-top:16px;
  padding:15px;
  font-size:17px;
  border:none;
  border-radius:30px;
  cursor:pointer;
  background:linear-gradient(135deg,var(--saffron),var(--deep));
  color:white;
  font-weight:600;
  letter-spacing:.4px;
  transition:.25s;
}

button:hover{
  transform:translateY(-1px);
  box-shadow:0 10px 25px rgba(184,92,0,.45);
}

/* ================= TEXT ================= */
small{
  display:block;
  color:#6b4a2e;
  font-size:13px;
  margin-top:-4px;
}

.success{
  color:#1e7e34;
  font-weight:bold;
}

.error{
  color:#c0392b;
  font-weight:bold;
}

.hidden{display:none}

/* ================= FOOT ================= */
.footer-note{
  text-align:center;
  margin-top:14px;
  font-size:13px;
  color:#6b3a00;
}
</style>
</head>

<body>

<div class="card">

  <h2>üõï Mandir Admin Onboarding</h2>
  <div class="subtitle">Register your Mandir into the Smart Darshan System</div>

  <input id="mandirName" placeholder="Mandir Name (Official)">
  <input id="latitude" type="number" step="any" placeholder="üìç Latitude (e.g. 27.5816)">
  <input id="longitude" type="number" step="any" placeholder="üìç Longitude (e.g. 77.7006)">
  <small>‚ö†Ô∏è Prototype mode ‚Äî manual coordinates</small>

  <input id="adminName" placeholder="Authorized Admin Full Name">
  <input id="phone" placeholder="Official Phone Number (+91XXXXXXXXXX)">
  <input id="email" placeholder="Official Gmail ID (abc@gmail.com)">

  <button onclick="makePayment()">üí≥ Pay & Register Mandir</button>

  <p id="statusMsg" class="hidden"></p>
  <p id="adminIdDisplay" class="success hidden"></p>

  <div class="footer-note">üôè Digital Darshan ‚Ä¢ Queue with Devotion</div>

</div>

<!-- ================= FIREBASE ================= -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyBeTQdKmRH788wMrQh4x-IkEt6lt4_rd4E",
  authDomain: "darshan-app-48a19.firebaseapp.com",
  databaseURL: "https://darshan-app-48a19-default-rtdb.firebaseio.com",
  projectId: "darshan-app-48a19",
  messagingSenderId: "1036337719358",
  appId: "1:1036337719358:web:edabaf639a8cabfccb896f"
});
const db = firebase.database();

/* ================= PAYMENT (DEMO) ================= */
function makePayment(){
  const data = getData();
  if(!data) return;
  setStatus("Processing payment & registering mandir‚Ä¶");
  setTimeout(()=>registerMandir(data),1000);
}

/* ================= REGISTER ================= */
function registerMandir(d){
  const templeId = d.mandirName.toLowerCase().replace(/[^a-z0-9]+/g,"_");
  const adminId = "ADM-" + Math.floor(100000 + Math.random()*900000);

  db.ref("mandirs/"+templeId).set({
    mandirName:d.mandirName,
    location:{lat:d.lat,lng:d.lng},
    adminId,
    createdAt:Date.now()
  });

  db.ref("admins/"+adminId).set({
    templeId,
    name:d.adminName,
    phone:d.phone,
    email:d.email,
    active:true,
    createdAt:Date.now()
  });

  db.ref("batchSettings/"+templeId).set({
    peoplePerBatch:50,
    timePerBatch:10
  });

  setStatus("‚úÖ Mandir registered successfully");
  adminIdDisplay.innerText = "üîê Your Admin ID: " + adminId;
  adminIdDisplay.classList.remove("hidden");
}

/* ================= HELPERS ================= */
function getData(){
  const mandirNameVal = mandirName.value.trim();
  const lat = parseFloat(latitude.value);
  const lng = parseFloat(longitude.value);
  const adminNameVal = adminName.value.trim();
  const phoneVal = phone.value.trim();
  const emailVal = email.value.trim();

  if(!mandirNameVal||!adminNameVal||!phoneVal||!emailVal){
    setStatus("‚ùå Fill all fields",true); return null;
  }
  if(isNaN(lat)||isNaN(lng)){
    setStatus("‚ùå Invalid latitude / longitude",true); return null;
  }
  if(!/^\+91[6-9]\d{9}$/.test(phoneVal)){
    setStatus("‚ùå Phone must be +91 followed by 10 digits",true); return null;
  }
  if(!/^[^@]+@gmail\.com$/.test(emailVal)){
    setStatus("‚ùå Only valid Gmail ID allowed",true); return null;
  }

  return { mandirName:mandirNameVal, lat, lng, adminName:adminNameVal, phone:phoneVal, email:emailVal };
}

function setStatus(msg,isError=false){
  const el = document.getElementById("statusMsg");
  el.innerText = msg;
  el.className = isError ? "error" : "success";
  el.classList.remove("hidden");
}
</script>

</body>
</html>

